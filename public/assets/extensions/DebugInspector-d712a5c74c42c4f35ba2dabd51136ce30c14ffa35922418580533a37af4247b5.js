"use strict";function DebugInspector(e,t,n){function i(e){e.isTransactionFinished&&s.rebuildViews()}this.inspectedProps={},this.collection=null,this.tracked={},this.diagram=t,this.acceptButton=!!n.acceptButton,this.resetButton=!!n.resetButton,this.acceptFocus=!!n.acceptFocus,this.whenSelected=n.whenSelected===undefined||!!n.whenSelected,this.inspectPredicate=n.inspectPredicate||null,this.propertyPredicate=n.propertyPredicate||null,this.propertyNames=n.propertyNames||null;var o=document.getElementById(e);o.className="inspector-container";var a=document.createElement("select");o.appendChild(a);var r=document.createElement("div");r.className="inspector",o.appendChild(r);var l=document.createElement("div");l.className="inspector-button-container",o.appendChild(l),this.div=r,this.acceptResetDiv=l,this.chooser=a,this.lastIndex=0;var s=this;if(t.addModelChangedListener?t.addModelChangedListener(i):t.model.addChangedListener(i),this.whenSelected){var u=this.inspectPredicate;t.addDiagramListener("ChangedSelection",function(){var e=[],n=t.selection.first();if(null===n)return void s.toggleVisibility(!1);null!==s.propertyNames?s.populatePropertyNames(e,u,n):s.populateDefault(e,u,n),a.innerHTML="";for(var i=0;i<e.length;i++){var o=document.createElement("option");o.value=i,o.text=e[i]instanceof go.GraphObject?e[i].toString():"data",a.appendChild(o)}a.onchange=function(){var t=this.selectedIndex;null!==s.propertyNames?s.change(n):s.change(e[t]),s.lastIndex=t},s.toggleVisibility(!0);var r=s.lastIndex<=e.length-1;null!==s.propertyNames?s.change(n):s.change(e[r?s.lastIndex:0]),r&&(a.value=s.lastIndex)})}this.acceptFocus&&(o.tabIndex=3,o.addEventListener("focusout",function(){s.setAllProperties()})),this.toggleVisibility(!1)}function View(e,t){t=t||{},this.options=t,this.getter=t.getter||View.defaultGetter,this.setter=t.setter||View.defaultSetter,this.inialized=!1,this.visible=!0,this.dom=null,this.originalValue=null,this.object=e}window.DebugLocales={X:"X\u5750\u6807",Y:"Y\u5750\u6807",location:"\u5750\u6807","Offset X":"X\u504f\u79fb","Offset Y":"Y\u504f\u79fb",locationSpot:"\u4e2d\u5fc3\u70b9",resizable:"\u53ef\u8c03\u6574\u5927\u5c0f",rotatable:"\u53ef\u65cb\u8f6c",isShadowed:"\u662f\u5426\u6709\u9634\u5f71",type:"\u7c7b\u578b",Top:"\u9876\u90e8",Right:"\u53f3\u4fa7",Bottom:"\u5e95\u90e8",Left:"\u5de6\u4fa7",padding:"\u5185\u8fb9\u754c",defaultAlignment:"\u9ed8\u8ba4\u5bf9\u9f50\u65b9\u5f0f",defaultStretch:"\u9ed8\u8ba4\u62c9\u4f38\u65b9\u5f0f",Width:"\u5bbd\u5ea6",Height:"\u9ad8\u5ea6",gridCellSize:"\u7f51\u683c\u5927\u5c0f",gridOrigin:"\u7f51\u683c\u539f\u70b9",stretch:"\u62c9\u4f38",name:"\u540d\u79f0",opacity:"\u900f\u660e\u5ea6",visible:"\u53ef\u89c1",areaBackground:"\u533a\u57df\u80cc\u666f",background:"\u80cc\u666f",position:"\u4f4d\u7f6e",scale:"\u7f29\u653e",angle:"\u89d2\u5ea6",desiredSize:"\u9884\u671f\u5927\u5c0f",measuredBounds:"\u6d4b\u91cf\u8fb9\u754c",naturalBounds:"\u81ea\u7136\u8fb9\u754c",portId:"\u8fde\u7ebf\u7aef\u70b9",minSize:"\u6700\u5c0f\u5c3a\u5bf8",maxSize:"\u6700\u5927\u5c3a\u5bf8",isTreeExpanded:"\u662f\u5426\u53ef\u5c55\u5f00\u6811",category:"\u8282\u70b9\u7c7b\u578b",key:"\u4e3b\u952e",loc:"\u5750\u6807",__gohashid:"\u54c8\u5e0c\u503c",stroke:"\u63cf\u8fb9",fill:"\u586b\u5145",strokeWidth:"\u63cf\u8fb9\u7c97\u7ec6",strokeCap:"\u63cf\u8fb9\u5934\u90e8",strokeJoin:"\u63cf\u8fb9\u62d0\u89d2",strokeMiterLimit:"strokeMiterLimit",flaure:"flaure",figure:"\u5f62\u72b6",toArrow:"\u672b\u7aef\u7bad\u5934",fromArrow:"\u8d77\u70b9\u7bad\u5934",geometryStretch:"\u56fe\u5f62\u62c9\u4f38"},DebugInspector.prototype.populateDefault=function(e,t,n){(null===t||t(n))&&e.push(n);var i=function(n){if(n instanceof go.Panel)for(var o=n.elements;o.next();){var a=o.value;(null===t||t(a))&&e.push(a),i(a)}};i(n),(null===t||t(n.data))&&e.push(n.data)},DebugInspector.prototype.populatePropertyNames=function(e){e.push(this.propertyNames)},DebugInspector.prototype.change=function(e){this.inspectedProps={},this.setCollection(e),this.showObjectProperties(e)},DebugInspector.prototype.toggleVisibility=function(e){this.div.style.display=e?"block":"none",this.acceptResetDiv.style.display=e?"block":"none",this.chooser.style.display=e&&this.chooser.options.length>1?"block":"none"},DebugInspector.prototype.setCollection=function(e){this.collection=e},DebugInspector.prototype.rebuildViews=function(){for(var e=document.getElementsByClassName("sp-container");0!==e.length;)document.body.removeChild(e[0]);for(var t=this.div;0!==t.children.length;)t.removeChild(t.children[0]);this.acceptResetDiv.innerHTML="";for(var n=Object.keys(this.tracked),i=0;i<n.length;i++){for(var o=DebugInspector.createSection(n[i]),a=this.tracked[n[i]],r=0;r<a.length;r++){var l=a[r],s=this.inspectedProps[l];if(s&&!0===s.visible){o.appendChild(s.getDOM());var u=this.collection,p=s.dom,c=p.label||p.children[0];c.textContent=DebugLocales[l]||l;var d=p.children[1];if(s.options.readOnly)for(var h=0;h<p.children.length;h++)p.children[h].disabled=!0;var g=s.getType();if("Point"===g||"Size"===g||"Margin"===g||"Rect"===g||"Spot"==g)s.originalValue=s.getter(l).copy();else{var d;d="Brush"===g||"boolean"===g?p:p.children[1],s.originalValue=d.value}var f="";null!==u&&(f=s.getter(l)),s.inferredType=typeof f,f===undefined?f="":"(null)"===f?s.nullCheckBox.checked=!0:s.nullCheckBox&&(s.nullCheckBox.checked=!1),s.populate(f)}}t.appendChild(o)}var m=this;this.acceptButton&&this.buildButton("\u5e94\u7528",function(){m.setAllProperties(),m.rebuildViews()}),this.resetButton&&this.buildButton("\u91cd\u7f6e",function(){m.rebuildViews()})},DebugInspector.prototype.buildButton=function(e,t){if(this[e+"View"]===undefined){var n=document.createElement("input");n.type="button",n.value=e,n.addEventListener("click",t),this.viewName=n}this.acceptResetDiv.appendChild(this.viewName)},DebugInspector.prototype.setAllProperties=function(){if(null!==this.collection){var e=this.diagram;if(null!==e){var t=this.inspectedProps,n="set all properties";e.startTransaction(n);for(var i in t){var o=t[i];if(o&&null!==o.setter&&!o.options.readOnly){var a=o.isNull()?null:o.use(this);o.originalValue!==a&&((a instanceof go.Point||a instanceof go.Size||a instanceof go.Spot||a instanceof go.Rect||a instanceof go.Margin)&&o.originalValue.equals(a)||o.setter(e,o,i,a))}}e.commitTransaction(n)}}},DebugInspector.prototype.createProperty=function(e,t,n){var i=this.propertyPredicate;if(null===i||i(n,e)){var o=this.inspectedProps,a=new View(n,t);o[e]=a,a.name=e}},DebugInspector.prototype.appendProperty=function(e,t,n){var i=this.inspectedProps;this.createProperty(e,t,n),i[e]&&(i[e].visible=!0)},DebugInspector.prototype.hideAllProperties=function(){var e=this.inspectedProps;for(var t in e)e[t].visible=!1},DebugInspector.prototype.showObjectProperties=function(e){if(this.hideAllProperties(),null!==e){this.tracked={};var t=Object.getPrototypeOf(e);if(null!==this.propertyNames){var n=this.propertyNames,i=this.collection;for(var o in n)if(go[o]!==undefined&&go[o]._inspectedProperties!==undefined){var a=o;DebugInspector.createSection(a);this.tracked[a]=[];for(var r=n[o],l=0;l<r.length;l++){for(var s=r[l],u=null;null===u&&t&&t.constructor!==Object;)t.constructor._inspectedProperties[s]&&(u=t.constructor._inspectedProperties[s]),t=Object.getPrototypeOf(t);this.tracked[a].push(s),this.appendProperty(s,u,e)}}else{var a=o.substr(1),e=i.findObject(a);if(null===e)continue;DebugInspector.createSection(a);this.tracked[a]=[];for(var r=n[o],l=0;l<r.length;l++){var s=r[l];this.tracked[a].push(s),this.appendProperty(s,{},e)}}}else if(t.constructor===Object){var a="data";DebugInspector.createSection(a);this.tracked[a]=[];for(var s in e){var u={setter:View.defaultDataSetter};"__gohashid"===s&&(u.type="String",u.readOnly=!0),this.tracked[a].push(s),this.appendProperty(s,u,this.collection)}}else for(;t&&t.constructor!==Object;){var r=t.constructor._inspectedProperties,a=(new t.constructor).toString().split("#")[0].split("(")[0];DebugInspector.createSection(a);this.tracked[a]=[];for(var p in r)this.tracked[a].push(p),this.appendProperty(p,r[p],this.collection);t=Object.getPrototypeOf(t)}this.rebuildViews()}},DebugInspector.createSection=function(e){var t=document.createElement("div");t.className="inspector-section";var n=document.createElement("h3");return n.innerHTML=e+" \u5c5e\u6027",t.appendChild(n),t},View.prototype.getDOM=function(){return this.inialized||(this.dom=this.initialize(),this.inialized=!0),this.dom},View.prototype.getType=function(){return this.options.type||this.inferredType},View.prototype.isNullable=function(){if(this.options.nullable)return!0;var e=this.getType();return go[e]!==undefined&&!!go[e].nullable},View.prototype.isNull=function(){return this.isNullable()&&this.nullCheckBox&&this.nullCheckBox.checked},View.prototype.makeInspectorGroup=function(){var e=document.createElement("div");e.className="inspector-group";var t=document.createElement("label");t.textContent="LABEL",t.className="property-name";var n=t;if(this.isNullable()){e.className+=" inspector-nullable";var i=document.createElement("span");i.appendChild(t);var o=document.createElement("label"),a=document.createElement("span");a.textContent="Null?";var r=document.createElement("input");r.type="checkbox",o.appendChild(r),o.appendChild(a),i.appendChild(o),n=i,this.nullCheckBox=r}return e.appendChild(n),e.label=t,e},View.prototype.nFieldHTMLInit=function(e){for(var t=this.makeInspectorGroup(),n=2,i=[],o=[],a=function(){for(var e=document.createElement("div"),n=0;n<o.length;n++)e.appendChild(o[n]);e.className="row",t.appendChild(e),o=[]},r=0;r<e.length;r++){var l=document.createElement("label");l.textContent=DebugLocales[e[r]]||e[r],l.className="inspector-n-field-label";var s=document.createElement("input");s.className="input-short",i.push(s);var u=document.createElement("div");u.className="cell",u.appendChild(l),u.appendChild(s),o.push(u),o.length%n==0&&a()}return 0!==o.length&&a(),this.inputs=i,t},View.prototype.initialize=function(){var e=(this.dom,this.getType()),t=null;switch(e){case"Enum":t=this.makeInspectorGroup();var n=document.createElement("select");t.appendChild(n);break;case"Margin":t=this.nFieldHTMLInit(["Top","Right","Bottom","Left"]);break;case"Point":t=this.nFieldHTMLInit(["X","Y"]);break;case"Rect":t=this.nFieldHTMLInit(["X","Y","Width","Height"]);break;case"Size":t=this.nFieldHTMLInit(["Width","Height"]);break;case"Spot":t=this.nFieldHTMLInit(["X","Y","Offset X","Offset Y"]);var n=(this.inputs,document.createElement("select")),i=0,o=document.createElement("option");o.value=-1,o.text="Custom Spot",n.appendChild(o);for(var a in go.Spot)if(go.Spot[a]instanceof go.Spot){var r=document.createElement("option");r.value=i,r.text=a,i++,n.appendChild(r)}n.value=-1,n.div=t,t.dropdown=n;var l=this;n.onchange=function(){var e=n[n.selectedIndex].text;if("Custom Spot"!==e){var t=go.Spot.parse(e);l.inputs[0].value=t.x,l.inputs[1].value=t.y,l.inputs[2].value=t.offsetX,l.inputs[3].value=t.offsetY}},t.selectIndex=t.children.length,t.appendChild(n);break;case"Brush":t=this.makeInspectorGroup();var s=document.createElement("input");s.type="text",t.appendChild(s);break;case"boolean":t=this.makeInspectorGroup();var u=document.createElement("input");u.type="checkbox",u.className="inspector-boolean-control";var p=t.children[0];p.className="make-inline",t.insertBefore(u,p),t.input=u;break;case"number":default:t=this.makeInspectorGroup();var u=document.createElement("input");u.type="text","number"===this.getType()&&(u.className+=" right-align"),u.className+=" input-long",t.appendChild(u),t.input=u}return t},View.prototype.populate=function(e){var t=this.dom;switch(this.getType()){case"Enum":for(var n=this.options.enumValues,i=this.dom.children[1];0!==i.children.length;)i.removeChild(i.children[0]);if(0===i.length)for(var o=0;o<n.length;o++){var a=document.createElement("option");a.value=o,a.innerHTML=n[o].toString().split(".")[1],i.appendChild(a)}for(var r=-1,o=0;o<i.length;o++)if(i[o].text===e.toString().split(".")[1]){r=o;break}i.value=r;break;case"Margin":this.nFieldHTMLPopulate([e.top,e.left,e.bottom,e.right]);break;case"Point":this.nFieldHTMLPopulate([e.x,e.y]);break;case"Rect":this.nFieldHTMLPopulate([e.x,e.y,e.width,e.height]);break;case"Size":this.nFieldHTMLPopulate([e.width,e.height]);break;case"Spot":if(e instanceof go.Spot){var l=null;for(var s in go.Spot)if(go.Spot[s]instanceof go.Spot&&go.Spot[s].equals(e)){l=s;break}var i=t.dropdown;if(null!==l){for(var r=-1,o=0;o<i.children.length;o++){var u=i.children[o];if(u.text===l){r=parseInt(u.value);break}}i.value=r}}"String"==typeof e&&(e=go.Spot.parse(e)),this.nFieldHTMLPopulate([e.x,e.y,e.offsetX,e.offsetY]);break;case"Brush":var p=(this.nullCheckBox,t.children[1]);"(null)"===e&&(e="black");var c=$(p);if("string"==typeof e||e.type===go.Brush.Solid){var d=e;e instanceof go.Brush&&(d=e.color);var h={replacerClassName:"spectrum-control",color:d,showAlpha:!0,showInput:!0,clickoutFiresChange:!0,showButtons:!1,preferredFormat:"hex"};c.spectrum(h)}else c.spectrum("destroy");e instanceof go.Brush&&(e=ExtendedBrush.stringify(e)),p.value=e;break;case"boolean":t.children[0].checked=e;break;case"number":default:t.children[1].value=e}},View.prototype.nFieldHTMLPopulate=function(e){for(var t=this.inputs,n=0;n<e.length;n++)t[n].value=e[n]},View.prototype.use=function(e){var t=this.dom,n=this.getType(),i=null;switch(n){case"Enum":i=this.options.enumValues[t.children[1].selectedIndex];break;case"Margin":var o=this.nFieldHTMLUse(4);i=new go.Margin(o[0],o[1],o[2],o[3]);break;case"Point":var o=this.nFieldHTMLUse(2);i=new go.Point(o[0],o[1]);break;case"Rect":var o=this.nFieldHTMLUse(4);i=new go.Rect(o[0],o[1],o[2],o[3]);break;case"Size":var o=this.nFieldHTMLUse(2);i=new go.Size(o[0],o[1]);break;case"Spot":var o=this.nFieldHTMLUse(4),a=this.dom.children[this.dom.selectIndex];if(0!==a.selectedIndex){var r=go.Spot.parse(a[a.selectedIndex].text),l=function(e,t){return e===t||isNaN(e)&&isNaN(t)};l(o[0],r.x)&&l(o[1],r.y)&&l(o[2],r.offsetX)&&l(o[3],r.offsetY)&&(i=r)}null===i&&(i=new go.Spot(o[0],o[1],o[2],o[3]));break;case"Brush":if(this.nullCheckBox.checked)i=null;else{var s=t.children[1].value,u=e.collection;u=u.part;i=ExtendedBrush.parse(s,u.measuredBounds.width,u.measuredBounds.height)}break;case"boolean":i=t.children[0].checked;break;case"number":i=parseFloat(t.input.value);break;default:i=t.input.value}return i},View.prototype.nFieldHTMLUse=function(){for(var e=[],t=this.inputs,n=0;n<t.length;n++)e[n]=parseFloat(t[n].value);return e},View.defaultGetter=function(e){var t=this.object[e];return null===t?"(null)":t},View.defaultDataGetter=function(e){return this.object[e]},View.defaultSetter=function(e,t,n,i){"number"===t.getType()&&(i=parseFloat(i)),this.object[n]=i},View.defaultDataSetter=function(e,t,n,i){e.model.setDataProperty(this.object,n,i)},go.GraphObject._inspectedProperties={stretch:{type:"Enum",enumValues:[go.GraphObject.None,go.GraphObject.Fill,go.GraphObject.Horizontal,go.GraphObject.Vertical,go.GraphObject.Default],defaultValue:go.GraphObject.Default},name:{type:"String",readOnly:!0},opacity:{type:"number",defaultValue:1},visible:{type:"boolean",defaultValue:!0},areaBackground:{type:"Brush",defaultValue:null},background:{type:"Brush",defaultValue:null},position:{type:"Point"},scale:{type:"number",defaultValue:1},angle:{type:"number",defaultValue:0},desiredSize:{type:"Size"},measuredBounds:{type:"Rect",readOnly:!0},naturalBounds:{type:"Rect",readOnly:!0},portId:{type:"string",nullable:!0,defaultValue:null},minSize:{type:"Size",defaultValue:new go.Size(0,0)},maxSize:{type:"Size",defaultValue:new go.Size(Infinity,Infinity)}},go.Shape._inspectedProperties={fill:{type:"Brush",defaultValue:"black"},stroke:{type:"Brush",defaultValue:"black"},strokeWidth:{type:"number",defaultValue:1},strokeCap:{type:"String",defaultValue:"butt"},strokeJoin:{type:"String",defaultValue:"miter"},strokeMiterLimit:{type:"number",defaultValue:10},figure:{type:"String",defaultValue:"None"},toArrow:{type:"String",defaultValue:"None"},fromArrow:{type:"String",defaultValue:"None"},geometryStretch:{type:"Enum",enumValues:[go.GraphObject.None,go.GraphObject.Fill,go.GraphObject.Uniform,go.GraphObject.Default],defaultValue:go.GraphObject.Default}},go.TextBlock._inspectedProperties={font:{type:"String",defaultValue:"10px sans-serif"},text:{type:"String"},textAlign:{type:"String",defaultValue:"start"},isMultiline:{type:"boolean",defaultValue:!0},isUnderline:{type:"boolean",defaultValue:!1},isStrikethrough:{type:"boolean",defaultValue:!1},wrap:{type:"Enum",enumValues:[go.TextBlock.WrapDesiredSize,go.TextBlock.WrapFit,go.TextBlock.None],defaultValue:go.TextBlock.WrapDesiredSize},overflow:{type:"Enum",enumValues:[go.TextBlock.OverflowClip,go.TextBlock.OverflowEllipsis],defaultValue:go.TextBlock.OverflowClip},stroke:{type:"Brush",defaultValue:"black"},lineCount:{type:"number",readOnly:!0},editable:{type:"boolean"}},go.Panel._inspectedProperties={type:{type:"Enum",enumValues:[go.Panel.Position,go.Panel.Vertical,go.Panel.Horizontal,go.Panel.Auto,go.Panel.Spot,go.Panel.Table,go.Panel.Viewbox,go.Panel.Link,go.Panel.TableRow,go.Panel.TableColumn,go.Panel.Grid],defaultValue:go.Panel.Position},padding:{type:"Margin",defaultValue:new go.Margin},defaultAlignment:{type:"Spot",defaultValue:go.Spot.Default},defaultStretch:{type:"Enum",enumValues:[go.GraphObject.None,go.GraphObject.Fill,go.GraphObject.Horizontal,go.GraphObject.Vertical,go.GraphObject.Default],defaultValue:go.GraphObject.Default},gridCellSize:{type:"Size",defaultValue:new go.Size(10,10)},gridOrigin:{type:"Point",defaultValue:new go.Point}},go.Part._inspectedProperties={location:{type:"Point"},locationSpot:{type:"Spot"},resizable:{type:"boolean",defaultValue:!1},rotatable:{type:"boolean",defaultValue:!1},isShadowed:{type:"boolean",defaultValue:!1}},go.Node._inspectedProperties={isTreeExpanded:{type:"boolean",defaultValue:!0}},go.Link._inspectedProperties={fromSpot:{type:"Spot"},toSpot:{type:"Spot"},relinkableFrom:{type:"boolean",defaultValue:!1},relinkableTo:{type:"boolean",defaultValue:!1},resegmentable:{type:"boolean",defaultValue:!1},reshapable:{type:"boolean",defaultValue:!1},midPoint:{type:"Point",readOnly:!0},midAngle:{type:"number",readOnly:!0},isOrthogonal:{type:"boolean",readOnly:!0},isAvoiding:{type:"boolean",readOnly:!0},corner:{type:"number",defaultValue:0},curve:{type:"Enum",enumValues:[go.Link.None,go.Link.Bezier,go.Link.JumpGap,go.Link.JumpOver],defaultValue:go.Link.None},curviness:{type:"number",defaultValue:NaN},routing:{type:"Enum",enumValues:[go.Link.Normal,go.Link.Orthogonal,go.Link.AvoidsNodes],defaultValue:go.Link.Normal},smoothness:{type:"number",defaultValue:.5}},go.Group._inspectedProperties={ungroupable:{type:"boolean",defaultValue:!1},isSubGraphExpanded:{type:"boolean",defaultValue:!0}},go.Picture._inspectedProperties={source:{type:"string"},imageStretch:{type:"Enum",enumValues:[go.GraphObject.None,go.GraphObject.Fill,go.GraphObject.Uniform,go.GraphObject.UniformToFill],defaultValue:go.GraphObject.None},naturalBounds:{type:"Rect",readOnly:!0},sourceRect:{type:"Rect",defaultValue:new go.Rect(NaN,NaN,NaN,NaN)}},go.Brush.nullable=!0;