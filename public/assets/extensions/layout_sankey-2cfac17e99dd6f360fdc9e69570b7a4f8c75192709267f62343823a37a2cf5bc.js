function SankeyLayout(){go.LayeredDigraphLayout.call(this)}function getAutoHeightForNode(e){for(var t=0,o=e.findLinksInto();o.next();){var a=o.value;t+=a.computeThickness()}for(var r=0,o=e.findLinksOutOf();o.next();){var a=o.value;r+=a.computeThickness()}var n=Math.max(t,r);return n<10&&(n=10),n}go.Diagram.inherit(SankeyLayout,go.LayeredDigraphLayout),SankeyLayout.prototype.createNetwork=function(){return this.diagram.nodes.each(function(e){var t=getAutoHeightForNode(e),o="bold "+Math.max(12,Math.round(t/8))+"pt Segoe UI, sans-serif",a=e.findObject("SHAPE"),r=e.findObject("TEXT"),n=e.findObject("LTEXT");a&&(a.height=t),r&&(r.font=o),n&&(n.font=o)}),go.LayeredDigraphLayout.prototype.createNetwork.call(this)},SankeyLayout.prototype.nodeMinColumnSpace=function(e,t){if(null===e.node){if(e.edgesCount>=1){for(var o=1,a=e.edges;a.next();){var r=a.value;if(null!=r.link){var n=r.link.computeThickness();n>o&&(o=n);break}}return Math.ceil(o/this.columnSpacing)}return 1}return go.LayeredDigraphLayout.prototype.nodeMinColumnSpace.call(this,e,t)},SankeyLayout.prototype.assignLayers=function(){go.LayeredDigraphLayout.prototype.assignLayers.call(this);for(var e=this.maxLayer,t=this.network.vertexes.iterator;t.next();){var o=t.value,a=o.node;a.key;0==o.destinationVertexes.count&&(o.layer=0),0==o.sourceVertexes.count&&(o.layer=e)}},SankeyLayout.prototype.commitLayout=function(){go.LayeredDigraphLayout.prototype.commitLayout.call(this);for(var e=this.network.edges.iterator;e.next();){var t=e.value.link;t&&t.curve===go.Link.Bezier&&t.invalidateRoute()}};