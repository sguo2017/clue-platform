"use strict";function Inspector(e,t,i){var n=document.getElementById(e);n.className="inspector",n.innerHTML="",this._div=n,this._diagram=t,this._inspectedProperties={},this.inspectedObject=null,this.includesOwnProperties=!0,this.declaredProperties={},this.inspectsSelection=!0,this.propertyModified=null,i!==undefined&&(i.includesOwnProperties!==undefined&&(this.includesOwnProperties=i.includesOwnProperties),i.properties!==undefined&&(this.declaredProperties=i.properties),i.inspectSelection!==undefined&&(this.inspectsSelection=i.inspectSelection),i.propertyModified!==undefined&&(this.propertyModified=i.propertyModified));var r=this;t.addModelChangedListener(function(e){e.isTransactionFinished&&r.inspectObject()}),this.inspectsSelection&&t.addDiagramListener("ChangedSelection",function(){r.inspectObject()})}Inspector.showIfNode=function(e){return e instanceof go.Node},Inspector.showIfLink=function(e){return e instanceof go.Link},Inspector.showIfGroup=function(e){return e instanceof go.Group},Inspector.showIfPresent=function(e,t){return e instanceof go.Part&&(e=e.data),"object"==typeof e&&e[t]!==undefined},Inspector.prototype.inspectObject=function(e){var t=e;if(t===undefined&&(t=this.inspectsSelection?this._diagram.selection.first():this.inspectedObject),null===t||this.inspectedObject===t)return this.inspectedObject=t,void this.updateAllHTML();this.inspectedObject=t;var i=this._div;if(i.innerHTML="",null!==t){var n=t instanceof go.Part?t.data:t;if(n){var r=document.createElement("table"),o=document.createElement("tbody");this._inspectedProperties={},this.tabIndex=0;var s=this.declaredProperties;for(var d in s){var a=s[d];if(this.canShowProperty(d,a,t)){var c="";a.defaultValue!==undefined&&(c=a.defaultValue),n[d]!==undefined&&(c=n[d]),o.appendChild(this.buildPropertyRow(d,c||""))}}if(this.includesOwnProperties)for(var d in n)"__gohashid"!==d&&(this._inspectedProperties[d]||s[d]&&!this.canShowProperty(d,s[d],t)||o.appendChild(this.buildPropertyRow(d,n[d])));r.appendChild(o),i.appendChild(r)}}},Inspector.prototype.canShowProperty=function(e,t,i){return!1!==t.show&&("function"!=typeof t.show||t.show(i,e))},Inspector.prototype.canEditProperty=function(e,t,i){var n=i instanceof go.Part?i.data:i,r=typeof n[e];if("function"===r||"object"===r)return!1;if(t){if(!0===t.readOnly)return!1;if("function"==typeof t.readOnly)return!t.readOnly(i,e)}return!0},Inspector.prototype.buildPropertyRow=function(e,t){function i(){a.updateAllProperties()}var n=(this._div,document.createElement("tr")),r=document.createElement("td");r.textContent=e,n.appendChild(r);var o=document.createElement("td"),s=document.createElement("input"),d=this.declaredProperties[e];s.tabIndex=this.tabIndex++;var a=this;return s.value=t,s.disabled=!this.canEditProperty(e,d,this.inspectedObject),d!==undefined&&"color"===d.type&&(s.setAttribute("type","color"),"color"===s.type&&(s.addEventListener("input",i),s.addEventListener("change",i),s.value=this.setColor(t))),this._diagram.model.isReadOnly&&(s.disabled=!0),"color"!==s.type&&s.addEventListener("blur",i),o.appendChild(s),n.appendChild(o),this._inspectedProperties[e]=s,n},Inspector.prototype.setColor=function(e){var t=document.createElement("canvas").getContext("2d");return t.fillStyle=e,t.fillStyle},Inspector.prototype.updateAllHTML=function(){var e=this._inspectedProperties,t=(this._diagram,this.inspectedObject instanceof go.Part),i=t?this.inspectedObject.data:this.inspectedObject;if(i)for(var n in e){var r=e[n],o=i[n];"color"===r.type?r.value=this.setColor(o):r.value=o}else for(var n in e){var r=e[n];"color"===r.type?r.value="#000000":r.value=""}},Inspector.prototype.updateAllProperties=function(){var e=this._inspectedProperties,t=this._diagram,i=this.inspectedObject instanceof go.Part,n=i?this.inspectedObject.data:this.inspectedObject;if(n){t.startTransaction("set all properties");for(var r in e){var o=e[r].value,s=this.declaredProperties[r];if(this.canEditProperty(r,s,this.inspectedObject)){var d="";switch(s!==undefined&&s.type!==undefined&&(d=s.type),""===d&&"boolean"==typeof n[r]&&(d="boolean"),d){case"boolean":o=!(0==o||"false"===o||"0"===o);break;case"number":o=parseFloat(o)}e[r].value=o,t.model.setDataProperty(n,r,o),null!==this.propertyModified&&this.propertyModified(r,o)}}t.commitTransaction("set all properties")}};