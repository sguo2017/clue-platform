function GoToolsUI(e,t,o,a){this._goTools=e,this._name=t,this._goToolsName=o,this._state=a,this._furnitureNodeData=null}Object.defineProperty(GoToolsUI.prototype,"goTools",{get:function(){return this._goTools}}),Object.defineProperty(GoToolsUI.prototype,"state",{get:function(){return this._state}}),Object.defineProperty(GoToolsUI.prototype,"name",{get:function(){return this._name}}),Object.defineProperty(GoToolsUI.prototype,"goToolsName",{get:function(){return this._goToolsName}}),Object.defineProperty(GoToolsUI.prototype,"furnitureData",{get:function(){return this._furnitureData},set:function(e){this._furnitureData=e}}),GoToolsUI.prototype.openElement=function(e,t){var o=document.getElementById(e);"hidden"===o.style.visibility&&(updateFileList(t),o.style.visibility="visible")},GoToolsUI.prototype.closeElement=function(e){var t=this.state.windows,o=this.state.menuButtons,a=document.getElementById(e);e===t.selectionInfoWindow.id&&(document.getElementById(o.selectionInfoWindowButtonId).innerHTML="Show Node Info Help <p class='shortcut'> (Ctrl + I)</p>"),e===t.palettesWindow.id&&(document.getElementById(o.palettesWindowButtonId).innerHTML="Show Palettes <p class='shortcut'> (Ctrl + P)</p>"),e===t.overviewWindow.id&&(document.getElementById(o.overviewWindowButtonId).innerHTML="Show Overview <p class='shortcut'> (Ctrl + E)</p>"),e===t.optionsWindow.id&&(document.getElementById(o.optionsWindowButtonId).innerHTML="Show Options <p class='shortcut'> (Ctrl + B)</p>"),e===t.statisticsWindow.id&&(document.getElementById(o.statisticsWindowButtonId).innerHTML="Show Statistics <p class='shortcut'> (Ctrl + G)</p>"),a.style.visibility="hidden"},GoToolsUI.prototype.hideShow=function(e){var t,o=document.getElementById(e),a=this.state.windows;switch(e){case a.selectionInfoWindow.id:t="Selection Help",char="I";break;case a.overviewWindow.id:t="Overview",char="E";break;case a.optionsWindow.id:t="Options",char="B";break;case a.statisticsWindow.id:t="Statistics",char="G";break;case a.palettesWindow.id:t="Palettes",char="P",furniturePalette.layoutDiagram(!0),wallPartsPalette.layoutDiagram(!0)}"visible"===o.style.visibility?(o.style.visibility="hidden",document.getElementById(e+"Button").innerHTML="Show "+t+"<p class='shortcut'> (Ctrl + "+char+" )</p>"):(o.style.visibility="visible",document.getElementById(e+"Button").innerHTML="Hide "+t+"<p class='shortcut'> (Ctrl + "+char+" )</p>")},GoToolsUI.prototype.adjustScale=function(e){var t=this.goTools;switch(t.startTransaction("Change Scale"),e){case"-":t.scale-=.1;break;case"+":t.scale+=.1}t.scale=parseFloat((.1*Math.round(t.scale/.1)).toFixed(2)),t.commitTransaction("Change Scale")},GoToolsUI.prototype.changeGridSize=function(){var e=this.goTools;e.skipsUndoManager=!0,e.startTransaction("change grid size");var t,o=document.getElementById(this.state.windows.optionsWindow.gridSizeInputId);isNaN(o.value)||null==o.value||""==o.value||o.value==undefined?(o.value=e.convertPixelsToUnits(10),t=parseFloat(o.value)):t=parseFloat(o.value),t=e.convertUnitsToPixels(t),e.grid.gridCellSize=new go.Size(t,t),e.toolManager.draggingTool.gridCellSize=new go.Size(t,t),e.model.setDataProperty(e.model.modelData,"gridSize",t),e.commitTransaction("change grid size"),e.skipsUndoManager=!1},GoToolsUI.prototype.searchFurniture=function(){for(var e=this,t=this.goTools,o=e.state.windows.palettesWindow.furniturePaletteId,a=document.getElementById(e.state.windows.palettesWindow.furnitureSearchInputId).value,i=null,n=0;n<t.palettes.length;n++){t.palettes[n].div.id==o&&(i=t.palettes[n])}null==e.furnitureData&&(e.furnitureData=i.model.nodeDataArray);var s=i.model.nodeDataArray.slice();if(null!==a&&a!==undefined&&""!==a){for(var n=0;n<s.length;n+=0){s[n].type.toLowerCase().includes(a.toLowerCase())?n++:s.splice(n,1)}i.model.nodeDataArray=s}else i.model.nodeDataArray=e.furnitureData;i.updateAllRelationshipsFromData()},GoToolsUI.prototype.checkboxChanged=function(e){var t=this.goTools,o=this.state.windows.optionsWindow.checkboxes;t.skipsUndoManager=!0,t.startTransaction("change preference");var a=document.getElementById(e);switch(e){case o.showGridCheckboxId:t.grid.visible=a.checked,t.model.modelData.preferences.showGrid=a.checked;break;case o.gridSnapCheckboxId:t.toolManager.draggingTool.isGridSnapEnabled=a.checked,t.model.modelData.preferences.gridSnap=a.checked;break;case o.wallGuidelinesCheckboxId:t.model.modelData.preferences.showWallGuidelines=a.checked;break;case o.wallLengthsCheckboxId:t.model.modelData.preferences.showWallLengths=a.checked,t.updateWallDimensions();break;case o.wallAnglesCheckboxId:t.model.modelData.preferences.showWallAngles=a.checked,t.updateWallAngles();break;case o.smallWallAnglesCheckboxId:t.model.modelData.preferences.showOnlySmallWallAngles=a.checked,t.updateWallAngles()}t.commitTransaction("change preference"),t.skipsUndoManager=!1},GoToolsUI.prototype.changeUnits=function(){return},GoToolsUI.prototype.setBehavior=function(e){var t=this.goTools,o=t.toolManager.mouseDownTools.elt(0),a=t.toolManager.mouseDownTools.elt(3);if("wallBuilding"===e){o.isEnabled=!0,a.isEnabled=!1,t.skipsUndoManager=!0,t.startTransaction("change wallWidth"),t.model.setDataProperty(t.model.modelData,"wallWidth",parseFloat(document.getElementById("wallWidthInput").value));var i=t.model.modelData.wallWidth;if(isNaN(i))t.model.setDataProperty(t.model.modelData,"wallWidth",5);else{var n=t.convertUnitsToPixels(i);t.model.setDataProperty(t.model.modelData,"wallWidth",n)}t.commitTransaction("change wallWidth"),t.skipsUndoManager=!1}"dragging"===e&&(o.isEnabled=!1,a.isEnabled=!0),t.nodes.iterator.each(function(e){e.clearAdornments()}),t.clearSelection()},GoToolsUI.prototype.updateUI=function(){return},GoToolsUI.prototype.updateStatistics=function(){return},GoToolsUI.prototype.fillRowsWithNodes=function(e,t,o){function a(e){return i.name+".setSelectionInfo("+i.goToolsName+".findPartForKey('"+e+"'))"}var i=(this.goTools,this),n=[];e.constructor!==Array?e.each(function(e){n.push(e)}):n=e;for(var s=0;s<n.length;s+=2){if(null===n[s].data)return void this.setSelectionInfo("Nothing selected");var l=n[s].data.key,r="MultiPurposeNode"!==n[s].data.caption?n[s].data.caption:n[s].data.text;if(n[s+1]!=undefined&&null!=n[s+1]){var d=n[s+1].data.key,c="MultiPurposeNode"!==n[s+1].data.caption?n[s+1].data.caption:n[s+1].data.text;t.innerHTML+=l===o?'<div class="row"><div class="col-2"><p class="data clickable selectedKey" onclick="'+a(l)+'">'+r+'</p></div><div class="col-2"><p class="data clickable" onclick="'+a(d)+'">'+c+"</p></div></div>":d===o?'<div class="row"><div class="col-2"><p class="data clickable" onclick="'+a(l)+'">'+r+'</p></div><div class="col-2"><p class="data clickable selectedKey" onclick="'+a(d)+'">'+c+"</p></div></div>":'<div class="row"><div class="col-2"><p class="data clickable"onclick="'+a(l)+'">'+r+'</p></div><div class="col-2"><p class="data clickable"onclick="'+a(d)+'">'+c+"</p></div></div>"}else t.innerHTML+=l===o?'<div class="row"><div class="col-2"><p class="data clickable selectedKey" onclick="'+a(l)+'">'+r+"</p></div></div>":'<div class="row"><div class="col-2"><p class="data clickable" onclick="'+a(l)+'">'+r+"</p></div></div>"}},GoToolsUI.prototype.setColor=function(){var e=this.goTools,t=e.selection.first(),o=document.getElementById(this.state.windows.selectionInfoWindow.colorPickerId);null!==o&&(e.startTransaction("recolor node"),e.model.setDataProperty(t.data,"color",o.value),e.model.setDataProperty(t.data,"stroke",invertColor(o.value)),e.commitTransaction("recolor node"))},GoToolsUI.prototype.setHeight=function(){var e=this.goTools,t=e.selection.first(),o=document.getElementById(this.state.windows.selectionInfoWindow.heightInputId),a=parseFloat(e.convertUnitsToPixels(o.value));if(isNaN(a))return alert("Please enter a number in the height input"),void setSelectionInfo(t,e);if(e.skipsUndoManager=!0,e.startTransaction("resize node"),!e.isReadOnly)if("WallGroup"!==t.category&&"WindowNode"!==t.category&&"DoorNode"!==t.category)e.model.setDataProperty(t.data,"height",a);else if("DoorNode"===t.category||"WindowNode"===t.category){var i=e.findPartForKey(t.data.group),n=t.location.copy();if(null!==i){var s=Math.sqrt(i.data.startpoint.distanceSquaredPoint(i.data.endpoint));s<a&&(a=s,n=new go.Point((i.data.startpoint.x+i.data.endpoint.x)/2,(i.data.startpoint.y+i.data.endpoint.y)/2))}"DoorNode"===t.category&&e.model.setDataProperty(t.data,"width",a),t.location=n,e.updateWallDimensions()}else{var l=t.data.startpoint.copy(),r=t.data.endpoint.copy(),d=l.directionPoint(r),c=new go.Point((l.x+r.x)/2,(l.y+r.y)/2),p=new go.Point(c.x+a/2,c.y),u=new go.Point(c.x-a/2,c.y);p.offset(-c.x,-c.y).rotate(d).offset(c.x,c.y),u.offset(-c.x,-c.y).rotate(d).offset(c.x,c.y);var h,g=null,y=Number.MAX_VALUE,m=0;if(t.memberParts.iterator.each(function(e){var t=getWallPartEndpoints(e),o=t[0],a=t[1],i=Math.sqrt(o.distanceSquaredPoint(l)),n=Math.sqrt(a.distanceSquaredPoint(l));i<y&&(y=i,g=o),i>m&&(m=i,h=o),n<y&&(y=n,g=a),n>m&&(m=n,h=a)}),null!==g){var v=Math.sqrt(u.distanceSquaredPoint(p)),f=Math.sqrt(g.distanceSquaredPoint(h));v<f&&(u=g,p=h)}var w=null,I=0;if(t.memberParts.iterator.each(function(e){for(var t=getWallPartEndpoints(e),o=0;o<t.length;o++){var a=t[o],i=parseFloat(Math.sqrt(a.distanceSquaredPoint(u)).toFixed(2)),n=parseFloat(Math.sqrt(a.distanceSquaredPoint(p)).toFixed(2)),s=parseFloat(Math.sqrt(u.distanceSquaredPoint(p)).toFixed(2));if((i+n).toFixed(2)!==s.toFixed(2)){var l=Math.sqrt(a.distanceSquaredPoint(u));l>I&&(I=l,w=a)}}}),null!==w){var T=Math.sqrt(u.distanceSquaredPoint(p));if(w.distanceSquaredPoint(u)<w.distanceSquaredPoint(p)){u=w;var P=Math.sqrt(u.distanceSquaredPoint(p));p=new go.Point(u.x+T/P*(p.x-u.x),u.y+T/P*(p.y-u.y))}else{p=w;var P=Math.sqrt(u.distanceSquaredPoint(p));u=new go.Point(p.x+T/P*(u.x-p.x),p.y+T/P*(u.y-p.y))}}e.model.setDataProperty(t.data,"startpoint",u),e.model.setDataProperty(t.data,"endpoint",p),e.updateWall(t)}e.commitTransaction("resize node"),e.updateWallDimensions(e),e.skipsUndoManager=!1},GoToolsUI.prototype.setWidth=function(){var e=this.goTools,t=e.selection.first(),o=document.getElementById(this.state.windows.selectionInfoWindow.widthInputId);if(null!==o){var a=parseFloat(e.convertUnitsToPixels(o.value));if(isNaN(a))return alert("Please enter a number in the width input"),void setSelectionInfo(t,e);if(e.skipsUndoManager=!0,e.startTransaction("resize node"),!e.isReadOnly)if("WindowNode"===t.category){var i=e.findPartForKey(t.data.group),n=t.location.copy();if(null!==i){var s=getWallPartStretch(t),l=Math.sqrt(s.point1.distanceSquaredPoint(s.point2));l<a&&(a=l,n=new go.Point((s.point1.x+s.point2.x)/2,(s.point1.y+s.point2.y)/2))}e.model.setDataProperty(t.data,"width",a),t.location=n,e.updateWallDimensions()}else"WallGroup"===t.category?(e.model.setDataProperty(t.data,"strokeWidth",a),t.memberParts.iterator.each(function(t){"DoorNode"===t.category&&e.model.setDataProperty(t.data,"doorOpeningHeight",a),"WindowNode"===t.category&&e.model.setDataProperty(t.data,"height",a)})):e.model.setDataProperty(t.data,"width",a);e.commitTransaction("resize node"),e.skipsUndoManager=!1}},GoToolsUI.prototype.applySelectionChanges=function(){var e=this.goTools;this.setHeight(),this.setWidth(),this.setColor(),e.goToolsUI.setSelectionInfo(e.selection.first(),e)};