function WallBuildingTool(){go.Tool.call(this),this.name="WallBuilding",this._startPoint=null,this._endPoint=null,this._wallReshapingTool=null}go.Diagram.inherit(WallBuildingTool,go.Tool),Object.defineProperty(WallBuildingTool.prototype,"startPoint",{get:function(){return this._startPoint},set:function(t){this._startPoint=t}}),Object.defineProperty(WallBuildingTool.prototype,"endPoint",{get:function(){return this._endPoint},set:function(t){this._endPoint=t}}),Object.defineProperty(WallBuildingTool.prototype,"wallReshapingTool",{get:function(){return this._wallReshapingTool},set:function(t){this._wallReshapingTool=t}}),WallBuildingTool.prototype.canStart=function(){var t=this.diagram;return!(null===t||t.isReadOnly||!this.isEnabled)},WallBuildingTool.prototype.doActivate=function(){this.endPoint=null,this.startTransaction(this.name),this.isMouseCaptured=!0;var t=this.diagram,i=document.getElementById("wallWidthInput");i&&((isNaN(i.value)||null===i.value||""===i.value||i.value===undefined)&&(i.value=t.convertPixelsToUnits(5)),t.model.setDataProperty(t.model.modelData,"wallWidth",t.convertUnitsToPixels(parseFloat(i.value))));var o=this.diagram.lastInput.documentPoint,a=t.model.modelData.gridSize;this.diagram.toolManager.draggingTool.isGridSnapEnabled||(a=1);var l=a*Math.round(o.x/a),e=a*Math.round(o.y/a),n=new go.Point(l,e);this.startPoint=n,this.wallReshapingTool=this.diagram.toolManager.mouseDownTools.elt(3),this.isActive=!0},WallBuildingTool.prototype.doMouseDown=function(){var t=this.diagram;this.diagram.currentCursor="crosshair";var i={key:"wall",category:"WallGroup",caption:"Wall",type:"Wall",startpoint:this.startPoint,endpoint:this.startPoint,strokeWidth:parseFloat(t.model.modelData.wallWidth),isGroup:!0,notes:""};this.diagram.model.addNodeData(i);var o=t.findPartForKey(i.key);t.updateWall(o);var a=t.findPartForData(i);this.transactionResult=this.name,t.raiseDiagramEvent("PartCreated",a),this.wallReshapingTool.isEnabled=!0,t.select(a),this.wallReshapingTool.isBuilding=!0,this.wallReshapingTool.adornedShape=a.findObject("SHAPE"),this.wallReshapingTool.doActivate()},WallBuildingTool.prototype.doKeyDown=function(){var t=this.diagram;if("Esc"===t.lastInput.key){var i=t.selection.first();t.remove(i),t.pointNodes.iterator.each(function(i){t.remove(i)}),t.dimensionLinks.iterator.each(function(i){t.remove(i)}),t.pointNodes.clear(),t.dimensionLinks.clear(),this.doDeactivate()}go.Tool.prototype.doKeyDown.call(this)},WallBuildingTool.prototype.doMouseMove=function(){this.wallReshapingTool.doMouseMove()},WallBuildingTool.prototype.doDeactivate=function(){var t=this.diagram;this.diagram.currentCursor="",this.diagram.isMouseCaptured=!1,this.wallReshapingTool.isEnabled=!1,this.wallReshapingTool.adornedShape=null,this.wallReshapingTool.doDeactivate(),this.wallReshapingTool.isBuilding=!1,t.updateWallDimensions(),this.stopTransaction(this.name),this.isActive=!1};